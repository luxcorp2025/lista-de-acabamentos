<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Luxcorp • Lista de Acabamentos</title>

  <link rel="icon" type="image/png" sizes="32x32" href="assets/icons/icon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/icons/icon-16.png">
  <link rel="manifest" href="manifest.webmanifest">

  <meta name="theme-color" content="#0b0f14" />

  <!-- CSP que bloqueia injeções externas, mas permite seu JS local e o Live Reload -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 script-src 'self' blob: data:;
                 style-src 'self' 'unsafe-inline';
                 img-src 'self' data: blob:;
                 connect-src 'self' ws:;
                 frame-src 'self';">

  <style>
    :root{ --bg:#0e1320; --surface:#141b2f; --muted:#8fa1c9; --text:#e8edff; --accent:#4aa3ff; --danger:#ff6b7a; --radius:14px; }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0;font:500 16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Arial,sans-serif;
      background:radial-gradient(1200px 800px at -15% -10%, #1b295c 0%, transparent 60%),
                 radial-gradient(900px 700px at 120% 10%, #0f3447 0%, transparent 55%),var(--bg);
      color:var(--text)
    }
    .wrap{max-width:980px;margin:28px auto;padding:0 16px}

    header{display:grid;grid-template-columns:1fr auto;gap:16px;align-items:center}
    .brand-row{display:flex;align-items:center;gap:12px}
    .brand-row img{width:36px;height:36px;object-fit:contain;border-radius:8px}
    .brand-row h1{margin:0;font-size:28px;line-height:1}
    header p{margin:6px 0 0;color:var(--muted)}
    .toolbar{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end}
    .btn{
      border:1px solid rgba(255,255,255,.16);
      border-radius:12px;padding:10px 14px;background:linear-gradient(180deg,var(--accent),#2b79d7);
      color:#fff;font-weight:700;cursor:pointer;transition:transform .06s
    }
    .btn:active{transform:translateY(1px)}
    .btn.ghost{background:transparent}
    .btn.secondary{background:#18233d}
    .btn.tonal{background:#0c1427;border-color:rgba(255,255,255,.14)}
    .btn.danger{background:#4a1f2a;border-color:#c94962}
    .btn.small{padding:6px 10px;border-radius:10px;font-weight:600}

    .empty{color:var(--muted);text-align:center;padding:24px}

    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(5,8,16,.55);backdrop-filter:blur(4px);padding:16px;z-index:50}
    .modal.open{display:flex}
    .sheet{width:min(960px,100%);background:var(--surface);border:1px solid rgba(255,255,255,.14);border-radius:16px;box-shadow:0 30px 60px rgba(0,0,0,.45);overflow:hidden}
    .sheet header{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.1)}
    .sheet header h3{margin:0;font-size:18px}
    .sheet .body{padding:16px;max-height:70vh;overflow:auto}

    label{font-size:13px;color:var(--muted)}
    input[type="text"],input[type="number"],select{
      width:100%;background:#0c1427;border:1px solid rgba(255,255,255,.16);color:var(--text);
      padding:12px 14px;border-radius:12px;outline:none;transition:border .2s,box-shadow .2s
    }
    input:focus,select:focus{border-color:var(--accent);box-shadow:0 0 0 4px rgba(74,163,255,.18)}
    .row{display:grid;gap:12px;grid-template-columns:1fr}
    .row-2{display:grid;gap:12px;grid-template-columns:1fr 1fr}
    .row-3{display:grid;gap:12px;grid-template-columns:repeat(3,1fr)}
    @media (max-width:820px){ .row-3{grid-template-columns:1fr} .row-2{grid-template-columns:1fr} }

    .card{background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.1);border-radius:var(--radius);box-shadow:0 10px 30px rgba(0,0,0,.35);backdrop-filter:blur(6px)}
    .card .content{padding:14px}

    table.items{width:100%;border-collapse:collapse;margin-top:8px}
    table.items th, table.items td{border:1px solid rgba(255,255,255,.12);padding:8px 10px;text-align:left;vertical-align:top}
    table.items th{background:rgba(255,255,255,.05)}
    .muted{color:var(--muted);font-size:13px}
    .error{color:var(--danger);font-weight:700}

    .amb-list{display:grid;gap:12px;margin-top:16px}
    .amb-card{background:#0c1427;border:1px solid rgba(255,255,255,.12);border-radius:12px;padding:12px}
    .amb-card h4{margin:0 0 8px}
    .amb-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:8px}

    .hidden{display:none !important}
    .act{display:inline-flex;gap:6px;flex-wrap:wrap}

    /* Mobile */
    @media (max-width:640px){
      body{font-size:15px}
      .wrap{margin:16px auto}
      header .toolbar{justify-content:stretch}
      header .toolbar .btn{flex:1}
      .modal{align-items:flex-end}
      .sheet{width:100%;max-width:none;border-radius:16px 16px 0 0}
      .sheet .body{max-height:72vh}
      .act{display:flex}
      .act .btn{flex:1}
      .amb-actions{justify-content:stretch}
      .amb-actions .btn{flex:1}

      /* Tabela → cartões */
      table.items thead{display:none}
      table.items, table.items tbody, table.items tr, table.items td{display:block;width:100%}
      table.items tr{
        border:1px solid rgba(255,255,255,.12);
        border-radius:12px; padding:8px; margin-bottom:10px;
        background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));
      }
      table.items td{
        border:none; padding:6px 4px; display:flex; justify-content:space-between; gap:12px;
      }
      table.items td::before{
        content:attr(data-label);
        color:var(--muted); min-width:96px; flex:0 0 auto;
      }
      table.items td:last-child{padding-top:8px}
      .btn.small{padding:8px 10px}
    }

    /* Overlay de erro */
    #errOverlay{
      position:fixed; inset:auto 12px 12px 12px; background:#2b1f1f; color:#ffdede;
      border:1px solid #c94962; border-radius:12px; padding:10px 12px; font:13px/1.4 ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      z-index:9999; display:none; white-space:pre-wrap;
    }
  </style>
</head>
<body>
  <div class="wrap" id="appRoot">
    <header>
      <div>
        <div class="brand-row">
          <img src="assets/img/luxcorp-logo.png" alt="Luxcorp"
               onerror="this.onerror=null; this.src='assets/img/luxcorp-logo.jpg';">
          <h1>Lista de Acabamentos</h1>
        </div>
        <p>Crie a lista, adicione cômodos e exporte um PDF com o logo.</p>
      </div>
      <div class="toolbar">
        <button class="btn" id="btnAbrirAcab" type="button">+ Lista de acabamentos</button>
      </div>
    </header>

    <div class="empty">Clique em <strong>+ Lista de acabamentos</strong> para começar.</div>
  </div>

  <!-- Modal -->
  <div class="modal" id="modalAcab" aria-hidden="true">
    <div class="sheet" role="dialog" aria-modal="true" aria-labelledby="tituloAcab">
      <header>
        <h3 id="tituloAcab">Lista de Acabamentos</h3>
        <div class="toolbar">
          <button class="btn ghost" id="btnFecharAcab" type="button">Fechar</button>
          <button class="btn secondary" id="btnExportarAcab" type="button">Exportar PDF</button>
        </div>
      </header>
      <div class="body">
        <!-- Nome da lista -->
        <div class="row-2">
          <div><label for="nomeListaAcab">Nome da lista</label><input id="nomeListaAcab" type="text" placeholder="Ex.: Acabamentos – Apto 402" autocomplete="off" /></div>
          <div></div>
        </div>

        <!-- BLOCO NORMAL -->
        <div id="blocoNormal">
          <div class="row" style="margin-top:10px">
            <div class="card"><div class="content">
              <h4 style="margin:0 0 10px">Preencha o cômodo e salve itens</h4>

              <!-- Nome do cômodo -->
              <div class="row">
                <div><label for="nomeComodo">Nome do cômodo</label><input id="nomeComodo" type="text" placeholder="Ex.: Suíte, Cozinha" autocomplete="off" /></div>
              </div>

              <!-- TOMADAS -->
              <div class="row-3" style="margin-top:10px;align-items:end">
                <div>
                  <label for="tipoTomada">Tomada</label>
                  <select id="tipoTomada">
                    <option value="simples">Simples</option>
                    <option value="dupla">Dupla</option>
                    <option value="tripla">Tripla</option>
                  </select>
                </div>
                <div>
                  <label for="ampTomada">Amperagem</label>
                  <select id="ampTomada">
                    <option value="10">10A</option>
                    <option value="20">20A</option>
                  </select>
                </div>
                <div>
                  <label for="qtdTomada">Qtd</label>
                  <input id="qtdTomada" type="number" min="0" step="1" value="0">
                </div>
              </div>

              <!-- INTERRUPTOR normal -->
              <div class="row-3" style="margin-top:10px;align-items:end">
                <div>
                  <label for="tipoInt">Interruptor</label>
                  <select id="tipoInt">
                    <option value="is">Simples</option>
                    <option value="idu">Duplo</option>
                    <option value="itr">Triplo</option>
                  </select>
                </div>
                <div>
                  <label for="qtdInt">Qtd</label>
                  <input id="qtdInt" type="number" min="0" step="1" value="0">
                </div>
                <div></div>
              </div>

              <!-- PARALELO -->
              <div class="row-3" style="margin-top:10px;align-items:end">
                <div>
                  <label for="tipoIntPar">Interruptor paralelo</label>
                  <select id="tipoIntPar">
                    <option value="isp">Simples</option>
                    <option value="idup">Duplo</option>
                    <option value="itrp">Triplo</option>
                  </select>
                </div>
                <div>
                  <label for="qtdIntPar">Qtd</label>
                  <input id="qtdIntPar" type="number" min="0" step="1" value="0">
                </div>
                <div></div>
              </div>

              <!-- INTERMEDIÁRIO -->
              <div class="row-3" style="margin-top:10px;align-items:end">
                <div>
                  <label for="tipoIntMed">Interruptor intermediário</label>
                  <select id="tipoIntMed">
                    <option value="isi">Simples</option>
                    <option value="idui">Duplo</option>
                    <option value="itri">Triplo</option>
                  </select>
                </div>
                <div>
                  <label for="qtdIntMed">Qtd</label>
                  <input id="qtdIntMed" type="number" min="0" step="1" value="0">
                </div>
                <div></div>
              </div>

              <!-- CAMPAINHA -->
              <div class="row-3" style="margin-top:10px;align-items:end">
                <div>
                  <label for="qtdCamp">Campainha</label>
                  <input id="qtdCamp" type="number" min="0" step="1" value="0">
                </div>
                <div></div><div></div>
              </div>

              <!-- Ações principais -->
              <div class="row-2" style="margin-top:12px">
                <div class="act">
                  <button class="btn" id="btnSalvarItem" type="button">Salvar item</button>
                  <button class="btn secondary" id="btnPersonalizado" type="button">Acabamento personalizado</button>
                </div>
                <div class="act" style="justify-self:end">
                  <button class="btn" id="btnNovoComodo" type="button">Adicionar outro cômodo à lista</button>
                </div>
              </div>

              <!-- Itens do cômodo (tabela) -->
              <div id="wrapItensComodo" style="margin-top:12px"></div>
            </div></div>
          </div>
        </div>

        <!-- BLOCO PERSONALIZADO -->
        <div id="blocoPersonalizado" class="hidden">
          <div class="row" style="margin-top:10px">
            <div class="card"><div class="content">
              <h4 style="margin:0 0 10px">Acabamento personalizado</h4>
              <p class="muted" id="alvoPersInfo"></p>

              <!-- Bastidor -->
              <div class="row-3">
                <div>
                  <label for="bastidor">Bastidor</label>
                  <select id="bastidor">
                    <option value="4x2">4x2</option>
                    <option value="4x4">4x4</option>
                  </select>
                </div>
                <div>
                  <label for="qBast">Qtd bastidor</label>
                  <input id="qBast" type="number" min="0" step="1" value="0">
                </div>
                <div></div>
              </div>

              <!-- Espelho -->
              <div class="row-3" style="margin-top:10px">
                <div>
                  <label for="espelhoTipo">Espelho</label>
                  <select id="espelhoTipo">
                    <option value="4x2">4x2</option>
                    <option value="4x4">4x4</option>
                  </select>
                </div>
                <div>
                  <label for="espelhoEsp">Nº de espaços</label>
                  <select id="espelhoEsp">
                    <option value="1">1 espaço</option>
                    <option value="2">2 espaços</option>
                    <option value="3">3 espaços</option>
                    <option value="4">4 espaços</option>
                    <option value="5">5 espaços</option>
                    <option value="6">6 espaços</option>
                    <option value="cego">Cego</option>
                  </select>
                </div>
                <div>
                  <label for="qEsp">Qtd espelho</label>
                  <input id="qEsp" type="number" min="0" step="1" value="0">
                </div>
              </div>

              <!-- Interruptores módulos -->
              <div class="row-3" style="margin-top:10px;align-items:end">
                <div><label for="qIntS">Módulo de interruptor simples</label><input id="qIntS" type="number" min="0" step="1" value="0"></div>
                <div><label for="qIntP">Módulo de interruptor paralelo</label><input id="qIntP" type="number" min="0" step="1" value="0"></div>
                <div><label for="qIntI">Módulo de interruptor intermediário</label><input id="qIntI" type="number" min="0" step="1" value="0"></div>
              </div>

              <!-- Tomadas módulos -->
              <div class="row-3" style="margin-top:10px;align-items:end">
                <div><label for="qTom10">Módulo de tomada 10A</label><input id="qTom10" type="number" min="0" step="1" value="0"></div>
                <div><label for="qTom20">Módulo de tomada 20A</label><input id="qTom20" type="number" min="0" step="1" value="0"></div>
                <div></div>
              </div>

              <!-- RJ45 -->
              <div class="row-3" style="margin-top:10px;align-items:end">
                <div><label for="qRJ45_5e">Módulo RJ45 Cat 5e</label><input id="qRJ45_5e" type="number" min="0" step="1" value="0"></div>
                <div><label for="qRJ45_6e">Módulo RJ45 Cat 6e</label><input id="qRJ45_6e" type="number" min="0" step="1" value="0"></div>
                <div></div>
              </div>

              <!-- Antena + Pulsador + Dimer + Cego -->
              <div class="row-3" style="margin-top:10px;align-items:end">
                <div><label for="qAnt">Módulo de antena</label><input id="qAnt" type="number" min="0" step="1" value="0"></div>
                <div><label for="qPuls">Botão pulsador</label><input id="qPuls" type="number" min="0" step="1" value="0"></div>
                <div><label for="qDimer">Módulo dimer</label><input id="qDimer" type="number" min="0" step="1" value="0"></div>
              </div>
              <div class="row-3" style="margin-top:10px;align-items:end">
                <div><label for="qCego">Módulo cego</label><input id="qCego" type="number" min="0" step="1" value="0"></div>
                <div></div><div></div>
              </div>

              <div class="row-2" style="margin-top:12px">
                <button class="btn" id="btnAddPers" type="button">Salvar kit personalizado</button>
                <button class="btn secondary" id="btnVoltarNormal" type="button">Voltar</button>
              </div>

              <p class="muted" style="margin-top:10px">Ao salvar, cada item personalizado é adicionado como linha independente.</p>
            </div></div>
          </div>
        </div>

        <!-- Cômodos salvos -->
        <div class="amb-list" id="listaComodos"></div>
        <p class="muted" id="msgAcab"></p>
      </div>
    </div>
  </div>

  <div id="errOverlay"></div>

  <!-- JS externo com defer -->
  <script src="assets/app.js" defer></script>
</body>
</html>
